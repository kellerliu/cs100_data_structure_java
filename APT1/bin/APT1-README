Basically wrote the code myself, but discussed with Yuanjie. 
Totally took about two nights.